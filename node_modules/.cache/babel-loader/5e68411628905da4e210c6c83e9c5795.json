{"ast":null,"code":"var _jsxFileName = \"/Users/jenny/Desktop/SOAS/scheduler/src/FlightForm.js\";\nimport React from \"react\";\nimport \"./Form.css\";\nimport firebase from \"./Firebase.js\";\nimport { firebaseCreateDate } from \"./FirebaseHelper.js\";\nimport { RenderSuccessDialog } from \"./Overlay.js\";\nimport Const from \"./Const.js\";\nimport Helper from \"./Helper.js\";\n\nDate.prototype.toDateInputValue = function () {\n  var local = new Date(this);\n  local.setMinutes(this.getMinutes() - this.getTimezoneOffset());\n  return local.toJSON().slice(0, 10);\n};\n\nclass FlightForm extends React.Component {\n  constructor(props) {\n    super(props); //allPilotIDs\n\n    this.state = {\n      date: new Date().toDateInputValue(),\n      startTime: \"\",\n      endTime: \"\",\n      captain: \"\",\n      fo: \"\",\n      fe: \"\",\n      crew: \"\",\n      ac: \"\",\n      backup: \"\",\n      mission: \"\",\n      details: \"\",\n      config: \"\",\n      remarks: \"\",\n      pri: \"\",\n      meal: \"\",\n      dco: \"\",\n      type: \"flight\"\n    };\n  }\n\n  firebaseSetBool(pilot) {\n    if (pilot == \"\") {\n      console.error(\"invalid pilot\");\n      return;\n    }\n\n    var flightDate = 'flights.' + this.state.date;\n    firebase.firestore().collection(\"pilots\").doc(pilot).update({\n      [flightDate]: true\n    }).then(function () {\n      console.log(\"Boolean successfully set for pilot\");\n    }).catch(function (error) {\n      console.error(\"Error setting flight boolean\", error);\n    });\n  }\n\n  verifySubmit() {\n    var required = ['captain', 'fo', 'ac', 'mission', 'startTime', 'endTime'];\n    required.forEach(field => {\n      console.log(field);\n\n      if (this.state[field] == \"\") {\n        Helper.flag(field, \"Required\");\n        this.setState({\n          ok: false\n        });\n      }\n    });\n  }\n\n  onSubmit() {\n    var remove = document.getElementsByClassName('alert-validate');\n\n    for (let item of remove) {\n      item.classList.remove('alert-validate');\n    }\n\n    this.verifySubmit(); //If there are no errors\n\n    if (document.getElementsByClassName('alert-validate').length == 0) {\n      var newEvent = firebase.firestore().collection(\"events\").doc();\n      newEvent.set(this.state).then(function () {\n        console.log(\"Event successfully added to events!\");\n      }).catch(function (error) {\n        console.error(\"Error adding event: \", error);\n      });\n      this.firebaseSetBool(this.state.captain);\n      this.firebaseSetBool(this.state.fo);\n      var updates = {};\n      updates['events.' + this.state.captain] = firebase.firestore.FieldValue.arrayUnion({\n        'type': 'flight',\n        'startTime': this.state.startTime,\n        'endTime': this.state.endTime,\n        'id': newEvent.id\n      });\n      updates['events.' + this.state.fo] = firebase.firestore.FieldValue.arrayUnion({\n        'type': 'flight',\n        'startTime': this.state.startTime,\n        'endTime': this.state.endTime,\n        'id': newEvent.id\n      });\n      var newUpcomingEvents = [firebase.firestore().collection('pilots').doc(this.state.captain).collection('upcoming-events').doc(), firebase.firestore().collection('pilots').doc(this.state.fo).collection('upcoming-events').doc()];\n\n      if (this.state.fe) {\n        updates['events.' + this.state.fe] = firebase.firestore.FieldValue.arrayUnion({\n          'type': 'flight',\n          'startTime': this.state.startTime,\n          'endTime': this.state.endTime,\n          'id': newEvent.id\n        });\n        newUpcomingEvents.push(firebase.firestore().collection('pilots').doc(this.state.fe).collection('upcoming-events').doc());\n        this.firebaseSetBool(this.state.fe);\n      }\n\n      if (this.state.crew) {\n        updates['events.' + this.state.crew] = firebase.firestore.FieldValue.arrayUnion({\n          'type': 'flight',\n          'startTime': this.state.startTime,\n          'endTime': this.state.endTime,\n          'id': newEvent.id\n        });\n        newUpcomingEvents.push(firebase.firestore().collection('pilots').doc(this.state.crew).collection('upcoming-events').doc());\n        this.firebaseSetBool(this.state.crew);\n      }\n\n      let date = this.state.date;\n      firebase.firestore().collection(\"dates\").doc(date).update(updates).then(function () {\n        console.log(\"Event successfully added to dates!\");\n      }).catch(function (error) {\n        firebaseCreateDate(date);\n      });\n      newUpcomingEvents.forEach(x => {\n        x.set({\n          ac: this.state.ac,\n          captain: this.state.captain,\n          flightid: newEvent.id,\n          config: this.state.config,\n          date: this.state.date,\n          fo: this.state.fo,\n          fe: this.state.fe,\n          crew: this.state.crew,\n          details: this.state.details,\n          endTime: this.state.endTime,\n          startTime: this.state.startTime\n        }).then(function () {\n          console.log(\"Event successfully added to pilots!\");\n        }).catch(function (error) {\n          console.error(\"Error writing document: \", error);\n        });\n      }); //window.location.reload();\n\n      document.getElementsByClassName(\"success-modal\")[0].style.display = \"block\";\n    }\n  }\n\n  renderField(field) {\n    const name = field.name;\n    const displayName = field.hasOwnProperty(\"displayName\") ? field.displayName.toUpperCase() : field.name.toUpperCase();\n    const wrapperClassName = field.size + \"-wrapper\";\n    const fieldClassName = \"input\" + (this.state[name] != \"\" ? \" has-val\" : \"\");\n    var acceptedValues = [];\n\n    if ([\"captain\", \"fo\", \"fe\", \"crew\"].includes(field.name)) {\n      acceptedValues = this.props.allPilotIDs;\n    } //const datalist = field.hasOwnProperty('select') ? field.select : '';\n\n\n    return React.createElement(\"div\", {\n      id: name,\n      className: wrapperClassName + \" validate-input\",\n      onFocus: e => {\n        e.target.parentElement.classList.remove(\"alert-validate\");\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, Helper.getOptionsList('pilots', this.props.allPilotIDs), Helper.getOptionsList('dcolist', Const.dcolist), Helper.getOptionsList('aclist', Const.aclist), Helper.getOptionsList('configlist', Const.configlist), React.createElement(\"input\", {\n      className: fieldClassName,\n      type: \"text\",\n      name: name,\n      list: field.selectList,\n      onBlur: e => {\n        this.setState({\n          [name]: e.target.value.trim()\n        });\n        Helper.checkFieldError(name, e.target.value.trim(), acceptedValues);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"focus-input\",\n      \"data-placeholder\": displayName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }));\n  }\n\n  renderCustomField(field) {\n    switch (field.name) {\n      case \"flighttime\":\n        var _ref = [this.state.startTime, this.state.endTime],\n            start = _ref[0],\n            end = _ref[1];\n        var time = \"0 HRS 0 MIN\";\n        var hours = parseInt(end.substring(0, 2)) - parseInt(start.substring(0, 2));\n        var minutes = parseInt(end.substring(2, 4)) - parseInt(start.substring(2, 4));\n\n        if (hours < 0) {\n          hours += 24;\n        }\n\n        if (minutes < 0) {\n          minutes += 60;\n          hours -= 1;\n        }\n\n        if (minutes >= 60) {\n          minutes -= 60;\n          hours += 1;\n        }\n\n        if (hours >= 0 || minutes >= 0) {\n          time = hours + \" HRS \" + minutes + \" MIN\";\n        } else {\n          time = \"0 HRS 0 MIN\";\n        }\n\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"input has-val lengthField\",\n          type: \"text\",\n          disabled: true,\n          value: time,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }));\n\n      case \"date\":\n        return React.createElement(\"div\", {\n          className: \"medium-wrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"input has-val validate-input\",\n          type: \"date\",\n          name: \"date\",\n          defaultValue: new Date().toDateInputValue(),\n          onBlur: e => {\n            var d = new Date(e.target.value);\n            d.setMinutes(d.getMinutes() + d.getTimezoneOffset());\n            this.setState({\n              date: d.toDateInputValue()\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          className: \"focus-input\",\n          \"data-placeholder\": \"DATE\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }));\n\n      default:\n        const name = field.name;\n        const displayName = field.hasOwnProperty(\"displayName\") ? field.displayName.toUpperCase() : field.name.toUpperCase();\n        const fieldClassName = \"input validate-input\" + (this.state[name] != \"\" ? \" has-val\" : \"\");\n        return React.createElement(\"div\", {\n          id: name,\n          className: field.size + \"-wrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: fieldClassName,\n          autoComplete: \"new-password\",\n          required: field.required,\n          type: \"number\",\n          name: name,\n          onBlur: e => {\n            this.setState({\n              [name]: e.target.value.trim()\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          className: \"focus-input\",\n          \"data-placeholder\": displayName,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209\n          },\n          __self: this\n        }));\n    }\n  }\n\n  renderRow(row) {\n    var fields = [];\n    Object.values(row).forEach(field => {\n      if (field.hasOwnProperty('custom')) {\n        fields.push(this.renderCustomField(field));\n      } else {\n        fields.push(this.renderField(field));\n      }\n    });\n    return React.createElement(\"div\", {\n      className: \"row-wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, fields);\n  }\n\n  renderForm() {\n    var rows = [];\n    Const.flightFormFields.forEach(row => {\n      console.log(row);\n      rows.push(this.renderRow(row));\n    });\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"form\",\n      autoComplete: \"off\",\n      onSubmit: e => {\n        e.preventDefault();\n        this.onSubmit();\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }, rows, React.createElement(RenderSuccessDialog, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }), Helper.RenderFormButton(this.props.onSubmit, \"Add Flight\")));\n  }\n\n  componentDidMount() {}\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, this.renderForm());\n  }\n\n}\n\nexport default FlightForm;","map":{"version":3,"sources":["/Users/jenny/Desktop/SOAS/scheduler/src/FlightForm.js"],"names":["React","firebase","firebaseCreateDate","RenderSuccessDialog","Const","Helper","Date","prototype","toDateInputValue","local","setMinutes","getMinutes","getTimezoneOffset","toJSON","slice","FlightForm","Component","constructor","props","state","date","startTime","endTime","captain","fo","fe","crew","ac","backup","mission","details","config","remarks","pri","meal","dco","type","firebaseSetBool","pilot","console","error","flightDate","firestore","collection","doc","update","then","log","catch","verifySubmit","required","forEach","field","flag","setState","ok","onSubmit","remove","document","getElementsByClassName","item","classList","length","newEvent","set","updates","FieldValue","arrayUnion","id","newUpcomingEvents","push","x","flightid","style","display","renderField","name","displayName","hasOwnProperty","toUpperCase","wrapperClassName","size","fieldClassName","acceptedValues","includes","allPilotIDs","e","target","parentElement","getOptionsList","dcolist","aclist","configlist","selectList","value","trim","checkFieldError","renderCustomField","start","end","time","hours","parseInt","substring","minutes","d","renderRow","row","fields","Object","values","renderForm","rows","flightFormFields","preventDefault","RenderFormButton","componentDidMount","render"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./Form.css\";\nimport firebase from \"./Firebase.js\";\nimport {firebaseCreateDate} from \"./FirebaseHelper.js\";\nimport {RenderSuccessDialog} from \"./Overlay.js\";\nimport Const from \"./Const.js\";\nimport Helper from \"./Helper.js\";\n\nDate.prototype.toDateInputValue = (function() {\n    var local = new Date(this);\n    local.setMinutes(this.getMinutes() - this.getTimezoneOffset());\n    return local.toJSON().slice(0,10);\n});\n\n\n\n\nclass FlightForm extends React.Component {\n    constructor(props) { \n        super(props);\n        //allPilotIDs\n        this.state = {\n            date: new Date().toDateInputValue(),\n            startTime: \"\",\n            endTime: \"\",\n            captain: \"\",\n            fo: \"\",\n            fe: \"\",\n            crew: \"\",\n            ac: \"\",\n            backup: \"\",\n            mission: \"\",\n            details: \"\",\n            config: \"\",\n            remarks: \"\",\n            pri: \"\",\n            meal: \"\",\n            dco: \"\",\n            type: \"flight\",\n        }\n    }\n\n    firebaseSetBool(pilot) {\n        if (pilot == \"\") {\n            console.error(\"invalid pilot\");\n            return;\n        }\n        var flightDate = 'flights.' + this.state.date;\n        firebase.firestore().collection(\"pilots\").doc(pilot).update({[flightDate]: true})\n        .then(function() {\n            console.log(\"Boolean successfully set for pilot\");})\n        .catch(function(error) {\n            console.error(\"Error setting flight boolean\", error);\n        })\n    }\n\n    verifySubmit() {\n        var required = ['captain', 'fo', 'ac', 'mission', 'startTime', 'endTime'];\n        required.forEach(field => {\n            console.log(field);\n            if (this.state[field] == \"\") {\n                Helper.flag(field, \"Required\");\n                this.setState({ok: false});\n            }\n        })\n    }\n\n    onSubmit() { \n        var remove = document.getElementsByClassName('alert-validate');\n        for (let item of remove) {\n            item.classList.remove('alert-validate');\n        }\n        \n        this.verifySubmit();\n        \n        //If there are no errors\n        if (document.getElementsByClassName('alert-validate').length == 0) {\n            var newEvent = firebase.firestore().collection(\"events\").doc();\n            newEvent.set(this.state)\n            .then(function() {\n                console.log(\"Event successfully added to events!\");})\n            .catch(function(error) {\n                console.error(\"Error adding event: \", error);\n            });\n\n            this.firebaseSetBool(this.state.captain);\n            this.firebaseSetBool(this.state.fo);\n            var updates = {};\n            updates['events.'+this.state.captain] = firebase.firestore.FieldValue.arrayUnion({'type':'flight', 'startTime': this.state.startTime, 'endTime': this.state.endTime, 'id':newEvent.id});\n            updates['events.'+this.state.fo] = firebase.firestore.FieldValue.arrayUnion({'type':'flight', 'startTime': this.state.startTime, 'endTime': this.state.endTime, 'id':newEvent.id});\n            var newUpcomingEvents = [   firebase.firestore().collection('pilots').doc(this.state.captain).collection('upcoming-events').doc(),\n                                        firebase.firestore().collection('pilots').doc(this.state.fo).collection('upcoming-events').doc()];\n\n            if (this.state.fe) {\n                updates['events.'+this.state.fe] = firebase.firestore.FieldValue.arrayUnion({'type':'flight', 'startTime': this.state.startTime, 'endTime': this.state.endTime, 'id':newEvent.id});\n                newUpcomingEvents.push(firebase.firestore().collection('pilots').doc(this.state.fe).collection('upcoming-events').doc());\n                this.firebaseSetBool(this.state.fe);\n            }\n            if (this.state.crew) {\n                updates['events.'+this.state.crew] = firebase.firestore.FieldValue.arrayUnion({'type':'flight', 'startTime': this.state.startTime, 'endTime': this.state.endTime, 'id':newEvent.id});\n                newUpcomingEvents.push(firebase.firestore().collection('pilots').doc(this.state.crew).collection('upcoming-events').doc());\n                this.firebaseSetBool(this.state.crew);\n            }\n            let date = this.state.date;\n            firebase.firestore().collection(\"dates\").doc(date).update(updates)\n            .then(function() {\n                console.log(\"Event successfully added to dates!\");})\n            .catch(function(error) {\n                firebaseCreateDate(date);\n            })\n\n\n            newUpcomingEvents.forEach((x)=>{x.set({\n                ac: this.state.ac,\n                captain: this.state.captain,\n                flightid: newEvent.id,\n                config: this.state.config,\n                date: this.state.date,\n                fo: this.state.fo,\n                fe: this.state.fe,\n                crew: this.state.crew,\n                details: this.state.details,\n                endTime: this.state.endTime,\n                startTime: this.state.startTime,})\n            .then(function() {\n                console.log(\"Event successfully added to pilots!\");})\n            .catch(function(error) {\n                console.error(\"Error writing document: \", error);\n            })})\n\n            //window.location.reload();\n            document.getElementsByClassName(\"success-modal\")[0].style.display = \"block\";\n\n        }\n    }\n\n    renderField(field) {\n        const name = field.name;\n        const displayName = field.hasOwnProperty(\"displayName\") ? field.displayName.toUpperCase() : field.name.toUpperCase();\n        const wrapperClassName = field.size + \"-wrapper\";\n        const fieldClassName = \"input\"+ (this.state[name] != \"\" ? \" has-val\": \"\");\n        var acceptedValues = [];\n        if ([\"captain\", \"fo\", \"fe\", \"crew\"].includes(field.name)) {\n            acceptedValues = this.props.allPilotIDs;\n\n        }\n\n        //const datalist = field.hasOwnProperty('select') ? field.select : '';\n        return (\n            <div id={name} className={wrapperClassName + \" validate-input\"} onFocus={(e)=>{e.target.parentElement.classList.remove(\"alert-validate\")}}>\n\n            {Helper.getOptionsList('pilots', this.props.allPilotIDs)}\n            {Helper.getOptionsList('dcolist', Const.dcolist)}\n            {Helper.getOptionsList('aclist', Const.aclist)}\n            {Helper.getOptionsList('configlist', Const.configlist)}\n            <input className={fieldClassName} type=\"text\" name={name} list={field.selectList} \n                    onBlur={(e)=>{\n                        this.setState({[name]: e.target.value.trim()}); \n                        Helper.checkFieldError(name, e.target.value.trim(), acceptedValues)}}/>\n            <span className=\"focus-input\" data-placeholder={displayName}></span>\n            </div>\n            \n        )\n    }\n\n    renderCustomField(field) {\n        switch(field.name) {\n            case \"flighttime\": \n                \n                var [start, end] = [this.state.startTime, this.state.endTime];\n                var time = \"0 HRS 0 MIN\";\n                var hours = parseInt(end.substring(0, 2))- parseInt(start.substring(0, 2));\n                var minutes = parseInt(end.substring(2, 4))- parseInt(start.substring(2, 4));\n                \n                if (hours < 0) {\n                    hours += 24\n                }\n                if (minutes < 0) {\n                    minutes += 60;\n                    hours -= 1;\n                }\n                if (minutes >= 60) {\n                    minutes -= 60;\n                    hours += 1;\n                }\n                if (hours >= 0 || minutes >= 0){ \n                    time = hours + \" HRS \" + minutes + \" MIN\";\n                }\n                else {\n                    time = \"0 HRS 0 MIN\";\n                }\n                return (<div>\n                    <input className='input has-val lengthField' type=\"text\" disabled={true} value={time}/>\n                </div>);\n            \n            case \"date\": \n                return (<div className=\"medium-wrapper\">\n                <input className=\"input has-val validate-input\" type=\"date\" name=\"date\" defaultValue={new Date().toDateInputValue()} onBlur={(e)=>{var d = new Date(e.target.value);\n                    d.setMinutes( d.getMinutes() + d.getTimezoneOffset() );\n                    this.setState({date: d.toDateInputValue()});}}/>\n                <span className=\"focus-input\" data-placeholder=\"DATE\"></span>\n            </div>)\n            default: \n                const name = field.name;\n                const displayName = field.hasOwnProperty(\"displayName\") ? field.displayName.toUpperCase() : field.name.toUpperCase();\n                const fieldClassName = \"input validate-input\"+ (this.state[name] != \"\"? \" has-val\": \"\")\n                return (<div id={name} className={field.size + \"-wrapper\"}>\n                    <input className={fieldClassName} autoComplete=\"new-password\" required={field.required} type=\"number\" name={name} onBlur={(e)=>{this.setState({[name]: e.target.value.trim()});}}/>\n                    <span className=\"focus-input\" data-placeholder={displayName}></span>\n                </div>);\n        }\n    }\n\n    renderRow(row) {\n        var fields = [];\n        Object.values(row).forEach(field => {\n            if (field.hasOwnProperty('custom')) {\n                fields.push(this.renderCustomField(field));\n            }\n            else {\n                fields.push(this.renderField(field));\n            }\n            \n        });\n        return (\n            <div className=\"row-wrapper\"> \n                {fields}\n            </div>\n        )\n    }\n\n    renderForm() {\n        var rows = []\n        Const.flightFormFields.forEach(row => {\n            console.log(row);\n            rows.push(this.renderRow(row));\n        });\n        return (\n            <div>\n                <form className=\"form\" autoComplete=\"off\"  onSubmit={(e)=>{e.preventDefault(); this.onSubmit()}}>\n                    {rows}\n                    <RenderSuccessDialog/>\n                    {Helper.RenderFormButton(this.props.onSubmit, \"Add Flight\")}\n                </form>\n            </div>\n        );\n    }\n\n\n    componentDidMount() {\n    }\n\n    render() {\n        return (\n            <div>\n                {this.renderForm()}\n            </div>\n        );\n    }\n}\n\nexport default FlightForm;"]},"metadata":{},"sourceType":"module"}