{"ast":null,"code":"import XLSX from 'xlsx';\n\nfunction s2ab(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n\n  for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;\n\n  return buf;\n}\n\nconst download = (url, name) => {\n  let a = document.createElement('a');\n  a.href = url;\n  a.download = name;\n  a.click();\n  window.URL.revokeObjectURL(url);\n};\n\nfunction getFlightsFromID(ids) {\n  ids.forEach(id => {\n    firebase.firestore().collection(\"events\").doc(id).get().then(querySnapshot => {\n      var d = querySnapshot.data();\n      this.setState({\n        //TODO: show civil and day/night\n        twilightciv: d.twilightciv != null ? d.twilightciv : \"N/A\",\n        twilightnaut: d.twilightnaut != null ? d.twilightnaut : \"N/A\",\n        desksgtday: d.desksgtday != null ? d.desksgtday : \"N/A\",\n        desksgtnight: d.desksgtnight != null ? d.desksgtnight : \"N/A\",\n        mvp: d.mvp != null ? d.mvp : \"N/A\",\n        fdoday: d.fdoday != null ? d.fdoday : \"N/A\",\n        fdonight: d.fdonight != null ? d.fdonight : \"N/A\",\n        groundrun: d.groundrun != null ? d.groundrun : \"N/A\"\n      });\n    }).catch(function (error) {\n      firebaseCreateDate(date);\n    });\n  });\n}\n\nfunction Export() {\n  var data = [['lafsijoda', 'gsijaofafs', 'gsaijofa'], ['gajiopg', 'gsigdsjiogsafafs', 'wnqr'], ['gdsgdsgssijoda', 'gsijaofafs', 'gsaijofa']];\n  /* convert from array of arrays to workbook */\n\n  var worksheet = XLSX.utils.aoa_to_sheet(data);\n  var new_workbook = XLSX.utils.book_new();\n  XLSX.utils.book_append_sheet(new_workbook, worksheet, \"ExportedFile\");\n  /* write file */\n\n  const wbout = XLSX.write(new_workbook, {\n    type: 'binary',\n    bookType: \"xlsx\"\n  });\n  let url = window.URL.createObjectURL(new Blob([s2ab(wbout)], {\n    type: 'application/octet-stream'\n  }));\n  download(url, 'DailyFlyingOrder.xlsx');\n}\n\nexport default Export;","map":{"version":3,"sources":["/Users/jenny/Desktop/SOAS/scheduler/src/Export.js"],"names":["XLSX","s2ab","s","buf","ArrayBuffer","length","view","Uint8Array","i","charCodeAt","download","url","name","a","document","createElement","href","click","window","URL","revokeObjectURL","getFlightsFromID","ids","forEach","id","firebase","firestore","collection","doc","get","then","querySnapshot","d","data","setState","twilightciv","twilightnaut","desksgtday","desksgtnight","mvp","fdoday","fdonight","groundrun","catch","error","firebaseCreateDate","date","Export","worksheet","utils","aoa_to_sheet","new_workbook","book_new","book_append_sheet","wbout","write","type","bookType","createObjectURL","Blob"],"mappings":"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","sourcesContent":["import XLSX from 'xlsx';\n\nfunction s2ab(s) {\n    var buf = new ArrayBuffer(s.length);\n    var view = new Uint8Array(buf);\n    for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;\n    return buf;\n}\n\nconst download = (url, name) => {\n    let a = document.createElement('a')\n    a.href = url\n    a.download = name\n    a.click()\n\n    window.URL.revokeObjectURL(url)\n}\n\nfunction getFlightsFromID(ids) {\n    ids.forEach((id) => {\n        firebase.firestore().collection(\"events\").doc(id)\n            .get()\n            .then((querySnapshot) => {\n                var d = querySnapshot.data();\n                this.setState({\n                    //TODO: show civil and day/night\n                    twilightciv: d.twilightciv != null ?  d.twilightciv : \"N/A\",\n                    twilightnaut: d.twilightnaut != null ? d.twilightnaut : \"N/A\",\n                    desksgtday: d.desksgtday != null ? d.desksgtday : \"N/A\", \n                    desksgtnight: d.desksgtnight != null ? d.desksgtnight : \"N/A\", \n                    mvp: d.mvp != null ?  d.mvp: \"N/A\", \n                    fdoday: d.fdoday != null ? d.fdoday  : \"N/A\",\n                    fdonight: d.fdonight != null ? d.fdonight : \"N/A\",\n                    groundrun: d.groundrun != null ? d.groundrun : \"N/A\"})\n                \n            })\n            .catch(function(error) {\n                firebaseCreateDate(date);\n            });\n    })\n}\n\nfunction Export() {\n\n    var data = [['lafsijoda', 'gsijaofafs', 'gsaijofa'],['gajiopg', 'gsigdsjiogsafafs', 'wnqr'],['gdsgdsgssijoda', 'gsijaofafs', 'gsaijofa']];\n    /* convert from array of arrays to workbook */\n    var worksheet = XLSX.utils.aoa_to_sheet(data);\n    var new_workbook = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(new_workbook, worksheet, \"ExportedFile\");\n\n\n    /* write file */\n    const wbout = XLSX.write(new_workbook, {type:'binary', bookType:\"xlsx\"});\n\n    let url = window.URL.createObjectURL(new Blob([s2ab(wbout)], {type:'application/octet-stream'}))\n\n    download(url, 'DailyFlyingOrder.xlsx')\n}\n\nexport default Export;\n\n"]},"metadata":{},"sourceType":"module"}